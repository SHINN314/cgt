# 2025/11/1(土)実験の記録

## Chomp の勝率の理論値とシミュレーション値の比較

### 概要

2×n の Chomp における先手の勝率の理論値とシミュレーションの結果を可視化して比較した。

### 実行コマンドと結果

以下のコマンドを実行した。

```bash
uv run scripts/simulation.py
      Built cgt @ file:///home/shinn/university/jk/cgt
Uninstalled 1 package in 0.61ms
Installed 1 package in 5ms
kの値を入力してください (2xi, 1<=i<=kで計算): 50
グラフを保存するファイル名を入力してください (例: theory_vs_simulation_20250101.png): theory_vs_simulation_20251101_1.png
シミュレーション回数を入力してください (デフォルト: 10000):
i=1/50 を処理中...
/home/shinn/university/jk/cgt/src/recurrence_relation.py:57: RuntimeWarning: invalid value encountered in scalar divide
  winning_probability: float = 0.5 - (n * a_k + b_k) / (
  理論値: nan, シミュレーション値: 0.5079
i=2/50 を処理中...
  理論値: 0.4167, シミュレーション値: 0.5875
i=3/50 を処理中...
  理論値: 0.4556, シミュレーション値: 0.5378
i=4/50 を処理中...
  理論値: 0.4708, シミュレーション値: 0.5386
i=5/50 を処理中...
  理論値: 0.4788, シミュレーション値: 0.5214
i=6/50 を処理中...
  理論値: 0.4835, シミュレーション値: 0.5213
i=7/50 を処理中...
  理論値: 0.4867, シミュレーション値: 0.5141
i=8/50 を処理中...
  理論値: 0.4889, シミュレーション値: 0.5131
i=9/50 を処理中...
  理論値: 0.4906, シミュレーション値: 0.5098
i=10/50 を処理中...
  理論値: 0.4918, シミュレーション値: 0.5070
i=11/50 を処理中...
  理論値: 0.5002, シミュレーション値: 0.5051
i=12/50 を処理中...
/home/shinn/university/jk/cgt/src/recurrence_relation.py:57: RuntimeWarning: overflow encountered in scalar multiply
  winning_probability: float = 0.5 - (n * a_k + b_k) / (
  理論値: 0.5000, シミュレーション値: 0.5051
i=13/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5027
i=14/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5041
i=15/50 を処理中...
/home/shinn/university/jk/cgt/src/recurrence_relation.py:57: RuntimeWarning: overflow encountered in scalar add
  winning_probability: float = 0.5 - (n * a_k + b_k) / (
  理論値: 0.5000, シミュレーション値: 0.5109
i=16/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5184
i=17/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5100
i=18/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5050
i=19/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5094
i=20/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5001
i=21/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5084
i=22/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5006
i=23/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4915
i=24/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5026
i=25/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5099
i=26/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5001
i=27/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5024
i=28/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4968
i=29/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5072
i=30/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5027
i=31/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5015
i=32/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5016
i=33/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5144
i=34/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5057
i=35/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4980
i=36/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5042
i=37/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5093
i=38/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4984
i=39/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5034
i=40/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4997
i=41/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5134
i=42/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5037
i=43/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4992
i=44/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4954
i=45/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4902
i=46/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5036
i=47/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5036
i=48/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4939
i=49/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.4948
i=50/50 を処理中...
  理論値: 0.5000, シミュレーション値: 0.5062
```

結果は`results/theory_vs_simulation_20251101_1.png`に保存された。
画像を見ると 2×2 の盤面において理論値とのズレが確認できた。
偶然によるものか、プログラムのバグかわからないので調べる。

## 2✕2 盤面におけるシミュレーションの実行

### 概要

理論値とシミュレーション値で違いが出たことを踏まえて 2✕2 盤面のみで複数回実行して確率を擬似的に求め、可視化した。

### 実行コマンドと結果

```bash
uv run simulation.py
シミュレーションのバッチ回数を入力してください(デフォルト: 10): 100
各バッチでのシミュレーション回数を入力してください(デフォルト: 10000):
グラフを保存するファイル名を入力してください(デフォルト: square_chomp_simulation.png): square_chomp_simulation_20251101_1.png
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
Simulating 10000 games on a 2x2 board...
[0.5803, 0.5835, 0.5851, 0.5807, 0.5771, 0.5867, 0.5887, 0.5819, 0.5781, 0.5824, 0.5805, 0.5846, 0.5811, 0.5897, 0.5816, 0.5831, 0.5745, 0.5868, 0.5792, 0.5832, 0.5826,
0.5925, 0.5774, 0.5742, 0.5811, 0.5761, 0.5842, 0.5854, 0.5903, 0.5789, 0.5879, 0.5861, 0.5812, 0.5881, 0.5775, 0.5848, 0.5912, 0.5894, 0.584, 0.5727, 0.5803, 0.5879, 0.5851, 0.584, 0.5885, 0.5821, 0.5838, 0.5834, 0.5876, 0.5814, 0.5757, 0.5857, 0.5838, 0.5804, 0.5749, 0.5861, 0.5785, 0.5837, 0.5823, 0.5829, 0.5794, 0.5845, 0.5849, 0.5846, 0.5905, 0.5696, 0.5794, 0.58, 0.5895, 0.5888, 0.5837, 0.5752, 0.5877, 0.5781, 0.5722, 0.582, 0.5764, 0.5851, 0.5783, 0.575, 0.5811, 0.5816, 0.5878, 0.5899, 0.5786, 0.5795, 0.5825, 0.5825, 0.5843, 0.5876, 0.5883, 0.5837, 0.5865, 0.5851, 0.5872, 0.5856, 0.5799, 0.59, 0.5834, 0.5842]
```

画像は`result/square_chomp_simulation_20251101_1.png`に保存した。
見た感じ 6 割程をうろちょろしたい印象を持った。
バグの可能性が高い。
